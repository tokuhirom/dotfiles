#!/usr/bin/env perl
use strict;
use warnings;
use v5.10.0;

use Pod::Usage;
use Getopt::Long;

use Encode;
use Encode::Guess qw/utf8 euc-jp shiftjis 7bit-jis/;

GetOptions(
    'h' => \my $help,
    'g' => \my $guess,
    'j' => \my $jis,
    's' => \my $sjis,
) or pod2usage;

pod2usage() if $help;

my $outenc = do {
    if ($jis) {
        'iso-2022-jp'
    } elsif ($sjis) {
        'cp932'
    } else {
        'utf8'
    }
};

my $src = do { local $/; <> };
if ($guess) {
    say guess_encoding($src)->name;
    exit 0;
}

my $decoded = decode('Guess', $src);
print encode($outenc, $decoded);


# へろー美乳です。


__END__

=head1 SYNOPSIS

    nkf -w src.txt
